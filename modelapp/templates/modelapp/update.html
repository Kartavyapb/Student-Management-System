<!DOCTYPE html>
<html lang="en">
<head>

    {% load crispy_forms_tags %}

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr" crossorigin="anonymous">
    <title>Update Page</title>
</head>
<body>
    <h1> Here You Update Information of Student : </h1>

    <form action="" method="POST" enctype="multipart/form-data"> {% csrf_token %}

        {{ form | crispy}}

        <button type="submit"> Update + </button> 

    </form>

    <script>
    document.addEventListener('DOMContentLoaded', function () {
        const dobInput = document.getElementById('id_DOB');
        const ageInput = document.getElementById('id_Age');
        const totalFees = document.getElementById('id_Total_Fees');
        const paidFees = document.getElementById('id_Paid_Fees');
        const dueFees = document.getElementById('id_Due_Fees');

        function calculateAge() {
            const dobValue = dobInput.value;
            if (dobValue) {
                const dob = new Date(dobValue);
                const today = new Date();
                let age = today.getFullYear() - dob.getFullYear();
                const m = today.getMonth() - dob.getMonth();
                if (m < 0 || (m === 0 && today.getDate() < dob.getDate())) {
                    age--;
                }
                ageInput.value = age >= 0 ? age : 0;
            } else {
                ageInput.value = '';
            }
        }

        function updateDueFees() {
            const total = parseInt(totalFees.value) || 0;
            const paid = parseInt(paidFees.value) || 0;
            const due = total - paid;
            dueFees.value = due >= 0 ? due : 0;
        }

        if (dobInput && ageInput) {
            dobInput.addEventListener('change', calculateAge);
        }

        if (totalFees && paidFees && dueFees) {
            totalFees.addEventListener('input', updateDueFees);
            paidFees.addEventListener('input', updateDueFees);
        }
    });
</script>

</body>
</html>